# ProxyMaster v1.0.4 - 按标签页代理管理

## 🎉 重大功能更新

这个版本引入了**按标签页代理管理**功能，彻底解决了传统代理扩展的一个重要问题：混合连接导致的资源加载异常。

### 🔥 核心特性

#### 按标签页独立代理管理
- 每个标签页都有独立的代理状态
- 支持多标签页同时使用不同代理设置
- 标签页关闭时自动清理状态

#### 同源策略支持
- 同一标签页内的所有资源请求保持使用相同的代理设置
- 解决YouTube等网站的CDN资源加载问题
- 确保页面内容完整性和一致性

#### 智能资源继承
- 子资源自动继承主页面的代理设置
- 无需为每个CDN域名单独配置规则
- 支持复杂网站的完整代理访问

## ✨ 新增功能

### 标签页状态管理
```javascript
// 每个标签页的代理状态
{
  profile: 'proxy-name',     // 代理配置
  switchType: 'auto|manual', // 切换类型
  timestamp: 1234567890      // 设置时间
}
```

### 增强的调试工具
- 新增"标签页代理状态"查看功能
- 实时显示所有活跃标签页的代理设置
- 详细的状态信息和时间戳

### 智能网络请求处理
- 根据标签页状态动态调整代理设置
- 确保资源请求的一致性
- 优化网络连接性能

## 🎯 解决的问题

### 混合连接问题
**之前**：访问YouTube时，主页面走代理，但视频资源可能走直连，导致加载失败
**现在**：整个标签页的所有资源都使用一致的代理设置

### 多标签页冲突
**之前**：切换标签页时代理设置会相互影响
**现在**：每个标签页独立管理，互不干扰

### 复杂网站支持
**之前**：需要为每个CDN域名配置规则
**现在**：自动继承主域名的代理设置

## 🔧 技术改进

### 新增核心方法
- `setTabProxy(tabId, profileName, switchType)` - 设置标签页代理
- `getTabProxyStates()` - 获取标签页状态
- 增强的 `handleWebRequest()` 方法

### 事件监听优化
- 标签页更新事件处理
- 标签页关闭状态清理
- 网络请求智能路由

### 状态管理改进
- 内存中的标签页状态跟踪
- 自动状态清理机制
- 完整的调试信息

## 📚 使用指南

### 基本使用
1. 正常配置代理和自动切换规则
2. 访问网站时会自动为标签页设置代理
3. 该标签页的所有资源都会使用相同代理

### 调试功能
1. 打开 `chrome-extension://[id]/debug-autoswitch.html`
2. 点击"查看标签页状态"
3. 查看详细的代理状态信息

### 最佳实践
- 为主要网站配置自动切换规则
- 使用调试工具监控代理状态
- 根据需要手动调整特定标签页的代理

## 📖 文档更新

- 新增 [`TAB_PROXY_GUIDE.md`](TAB_PROXY_GUIDE.md) - 详细功能说明
- 更新 [`CHANGELOG.md`](CHANGELOG.md) - 完整更新记录
- 增强调试工具文档

## 🚀 升级建议

这是一个重要的功能更新，强烈建议所有用户升级：

1. **YouTube用户**：解决视频加载问题
2. **多标签页用户**：提供更好的使用体验
3. **企业用户**：支持复杂网络环境

## 🔄 兼容性

- 完全向下兼容现有配置
- 不影响已有的使用习惯
- 自动迁移现有设置

## 📞 反馈与支持

- **GitHub Issues**：https://github.com/tiantian0514/ProxyMaster/issues
- **邮箱**：hkhuangym@gmail.com
- **QQ群**：545380701

---

**下载地址**：
- [Chrome Web Store](https://chrome.google.com/webstore/detail/proxymaster)
- [GitHub Releases](https://github.com/tiantian0514/ProxyMaster/releases)

感谢所有用户的支持和反馈！🙏 